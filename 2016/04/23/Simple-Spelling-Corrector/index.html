<!DOCTYPE html><html lang="en"><head><meta charset="utf-8"><meta name="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1"><meta name="author" content="Alex Sinfarosa"><meta name="description" content="In“HowtoWriteaSpellingCorrector”http://norvig.com/spell-correct.html,Norvigdescribestraininghisalgorithmonaboutamillionword"><meta name="keywords" content="Machine Learning,Python,Spelling Corrector,Peter Norvig"><title>Simple Spelling Corrector · Alex Sinfarosa</title><link rel="icon" href="/"><link rel="canonical" href="http://.alexsinfarosa.com/2016/04/23/Simple-Spelling-Corrector/"><link rel="alternate" href="/atom.xml" title="Alex Sinfarosa"><link rel="stylesheet" href="/fonts/iconfont/iconfont.css"><link rel="stylesheet" href="/css/style.css"><script type="text/javascript"><!-- hexo-inject:begin --><!-- hexo-inject:end -->var _hmt = _hmt || [];
(function() {
  var hm = document.createElement("script");
  hm.src = "//hm.baidu.com/hm.js?Your baidu Analytics ID";
  var s = document.getElementsByTagName("script")[0]; 
  s.parentNode.insertBefore(hm, s);
})();
</script><script type="text/javascript">(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
})(window,document,'script','//www.google-analytics.com/analytics.js','ga');

ga('create', 'UA-84813198-1', 'auto');
ga('send', 'pageview');</script><!-- hexo-inject:begin --><!-- hexo-inject:end --></head><body><div id="main"><header><a href="/." class="logo">Alex Sinfarosa</a><ul class="nav"><li class="nav-link"><a href="/" target="_self">首页</a></li><li class="nav-link"><a href="/archives/" target="_self">归档</a></li><li class="nav-link"><a href="/tags/" target="_self">标签</a></li><li class="nav-link"><a href="/about/" target="_self">关于</a></li></ul></header><section id="container"><article class="post"><h1 class="post-title">Simple Spelling Corrector</h1><span class="post-time">Apr 23, 2016</span><div id="sidebar" class="post-sidebar"><h3 class="heading">目录</h3><ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#Bring-in-the-table…"><span class="toc-text">Bring in the table…</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Results"><span class="toc-text">Results</span></a></li></ol></div><div class="post-content"><p>In “How to Write a Spelling Corrector” <a href="http://norvig.com/spell-correct.html" target="_blank" rel="external">http://norvig.com/spell-correct.html</a>, Norvig describes training his algorithm on about a million words taken from several public domain books. Various precompiled word frequency lists are also available on the web, for example for all of the Project Gutenberg texts up to Apr 2006 at <a href="http://en.wiktionary.org/wiki/Wiktionary:Frequency_lists#Project_Gutenberg" target="_blank" rel="external">http://en.wiktionary.org/wiki/Wiktionary:Frequency_lists#Project_Gutenberg</a> .</p>
<!-- hexo-inject:begin --><!-- hexo-inject:end --><a id="more"></a>
<p>From that list, the frequencies per billion for the following selection of twenty four words are roughly</p>
<table><br><tr><td>fog 13,651 </td><td>for 7,097,981 </td><td>ford 15,620 </td><td>fore 6,699 </td><td>forge 3,893 </td><td>fork  8,219</td></tr><br><tr><br><td>form 307,506<br></td><td>fort 23,113<br></td><td>frog 4,119<br></td><td>go 816,536<br></td><td>god 552,668<br></td><td>good 966,602<br></td></tr><tr><br><td>gorge  6,177<br></td><td>got 432,016<br></td><td>groan 9,995<br></td><td>grow 64,005<br></td><td>grown 57,772<br></td><td>lord 422,407<br></td></tr><tr><br><td>more 1,899,787<br></td><td>nor 349,691<br></td><td>of 33,950,064<br></td><td>off 545,832<br></td><td>or 4,228,287<br></td><td>work 829,823<br></td></tr><br></table>


<p>Now, we would like to write a function <code>correct()</code> that returns the suggested corrected spelling for each of the four words: <strong>‘frog’</strong>, <strong>‘gorf’</strong>, <strong>‘forg’</strong>, and <strong>‘grof’</strong>.</p>
<h2 id="Bring-in-the-table…"><a href="#Bring-in-the-table…" class="headerlink" title="Bring in the table…"></a>Bring in the table…</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">table = &#123;<span class="string">"fog"</span>:<span class="number">13651</span>,<span class="string">"for"</span>:<span class="number">7097981</span>,<span class="string">"ford"</span>:<span class="number">15620</span>,<span class="string">"fore"</span>:<span class="number">6699</span>,<span class="string">"forge"</span>:<span class="number">3893</span>,<span class="string">"fork"</span>:<span class="number">8219</span>,<span class="string">"form"</span>:<span class="number">307506</span>,<span class="string">"fort"</span>:<span class="number">23113</span>,</div><div class="line">        <span class="string">"frog"</span>:<span class="number">4119</span>,<span class="string">"go"</span>:<span class="number">816536</span>,<span class="string">"god"</span>:<span class="number">552668</span>,<span class="string">"good"</span>:<span class="number">966602</span>,<span class="string">"gorge"</span>:<span class="number">6177</span>,<span class="string">"got"</span>:<span class="number">432016</span>,<span class="string">"groan"</span>:<span class="number">9995</span>,</div><div class="line">        <span class="string">"grow"</span>:<span class="number">64005</span>,<span class="string">"grown"</span>:<span class="number">57772</span>,<span class="string">"lord"</span>:<span class="number">422407</span>,<span class="string">"more"</span>:<span class="number">1899787</span>,<span class="string">"nor"</span>:<span class="number">349691</span>,<span class="string">"of"</span>:<span class="number">33950064</span>,<span class="string">"off"</span>:<span class="number">545832</span>,<span class="string">"or"</span>:<span class="number">4228287</span>,</div><div class="line">        <span class="string">"work"</span>:<span class="number">829823</span>&#125;</div></pre></td></tr></table></figure>
<p>Let’s get the functions <code>edits1</code> and <code>edits2</code> from Norvig’s article.</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">edits1</span><span class="params">(word)</span>:</span></div><div class="line">    <span class="string">"All edits that are one edit away from `word`."</span></div><div class="line">    alphabet = <span class="string">'abcdefghijklmnopqrstuvwxyz'</span></div><div class="line">    splits     = [(word[:i], word[i:]) <span class="keyword">for</span> i <span class="keyword">in</span> range(len(word) + <span class="number">1</span>)]</div><div class="line">    deletes    = [a + b[<span class="number">1</span>:] <span class="keyword">for</span> a, b <span class="keyword">in</span> splits <span class="keyword">if</span> b]</div><div class="line">    transposes = [a + b[<span class="number">1</span>] + b[<span class="number">0</span>] + b[<span class="number">2</span>:] <span class="keyword">for</span> a, b <span class="keyword">in</span> splits <span class="keyword">if</span> len(b)&gt;<span class="number">1</span>]</div><div class="line">    replaces   = [a + c + b[<span class="number">1</span>:] <span class="keyword">for</span> a, b <span class="keyword">in</span> splits <span class="keyword">for</span> c <span class="keyword">in</span> alphabet <span class="keyword">if</span> b]</div><div class="line">    inserts    = [a + c + b <span class="keyword">for</span> a, b <span class="keyword">in</span> splits <span class="keyword">for</span> c <span class="keyword">in</span> alphabet]</div><div class="line">    <span class="keyword">return</span> set(deletes + transposes + replaces + inserts)</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">edits2</span><span class="params">(word)</span>:</span></div><div class="line">    <span class="string">"All edits that are two edits away from `word`."</span></div><div class="line">    <span class="keyword">return</span> set(e2 <span class="keyword">for</span> e1 <span class="keyword">in</span> edits1(word) <span class="keyword">for</span> e2 <span class="keyword">in</span> edits1(e1) <span class="keyword">if</span> e2 <span class="keyword">in</span> table)</div></pre></td></tr></table></figure>
<p>Write a function that returns the maximum frequency candidate at edit distance 1.</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">d1</span><span class="params">(word)</span>:</span></div><div class="line">    arr = &#123;&#125;</div><div class="line">    d1 = edits1(word)</div><div class="line">    result = <span class="string">"None"</span></div><div class="line">    <span class="keyword">for</span> w <span class="keyword">in</span> d1:</div><div class="line">        <span class="keyword">if</span> w <span class="keyword">in</span> table.keys():</div><div class="line">            arr[w] = table[w]</div><div class="line">            result = max(arr, key=arr.get)</div><div class="line">    <span class="keyword">return</span> result</div></pre></td></tr></table></figure>
<p>If the candidate is not found at edit distance 1, then try edit distance 2.</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">d2</span><span class="params">(word)</span>:</span></div><div class="line">    arr = &#123;&#125;</div><div class="line">    d2 = edits2(word)</div><div class="line">    result = <span class="string">"None"</span></div><div class="line">    <span class="keyword">for</span> w <span class="keyword">in</span> d2:</div><div class="line">        <span class="keyword">if</span> w <span class="keyword">in</span> table.keys():</div><div class="line">            arr[w] = table[w]</div><div class="line">            result = max(arr, key=arr.get)</div><div class="line">    <span class="keyword">return</span> result</div></pre></td></tr></table></figure>
<p>Bring it all together</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">correct</span><span class="params">(table,list)</span>:</span></div><div class="line">    result = &#123;&#125;</div><div class="line">    <span class="keyword">for</span> w <span class="keyword">in</span> list:</div><div class="line">        <span class="keyword">if</span> w <span class="keyword">in</span> table:</div><div class="line">            result[w] = w</div><div class="line">        <span class="keyword">else</span>:</div><div class="line">            result[w] = d1(w)</div><div class="line">            <span class="keyword">if</span> result[w] == <span class="string">"None"</span>:</div><div class="line">                result[w] = d2(w)</div><div class="line">    <span class="keyword">return</span> result</div></pre></td></tr></table></figure>
<h2 id="Results"><a href="#Results" class="headerlink" title="Results"></a>Results</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">words_to_check = [<span class="string">'frog'</span>,<span class="string">'gorf'</span>,<span class="string">'forg'</span>,<span class="string">'grof'</span>]</div><div class="line"></div><div class="line">correct(table,words_to_check)</div></pre></td></tr></table></figure>
<pre><code>{&apos;forg&apos;: &apos;for&apos;, &apos;frog&apos;: &apos;frog&apos;, &apos;gorf&apos;: &apos;of&apos;, &apos;grof&apos;: &apos;grow&apos;}
</code></pre></div></article><div class="tags"><a href="/tags/Machine-Learning/">Machine Learning</a><a href="/tags/Python/">Python</a><a href="/tags/Spelling-Corrector/">Spelling Corrector</a><a href="/tags/Peter-Norvig/">Peter Norvig</a></div><div class="paginator"><a href="/2016/05/04/Logistic-Regression/" class="prev"><i class="iconfont icon-left"></i><span> 上一页</span></a><a href="/2016/03/16/Zipf-s-Law/" class="next"><span>下一页</span><i class="iconfont icon-right"></i></a></div><section id="comments"><div id="disqus_thread"></div></section><script type="text/javascript">var disqus_config = function () {
    this.page.url = 'http://.alexsinfarosa.com/2016/04/23/Simple-Spelling-Corrector/';
    this.page.identifier = '2016/04/23/Simple-Spelling-Corrector/';
    this.page.title = 'Simple Spelling Corrector';
};
(function() {
var d = document, s = d.createElement('script');

s.src = '//alexsinfarosa-com.disqus.com/embed.js';

s.setAttribute('data-timestamp', +new Date());
(d.head || d.body).appendChild(s);
})();</script></section><footer><div class="copyright"><p class="power">Powered by <a href="https://hexo.io/">Hexo</a> and Theme by <a href="https://github.com/ahonn/hexo-theme-even"> Even</a></p><p class="since">&copy;2016<span class="heart"><i class="iconfont icon-heart"></i></span><span class="author">Alex Sinfarosa</span></p></div><label id="back2top"><i class="iconfont icon-up"></i></label></footer></div><script src="/js/zepto.min.js"></script><script src="/js/theme.js"></script><!-- hexo-inject:begin --><!-- hexo-inject:end --></body></html>